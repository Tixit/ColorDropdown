!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.ColorDropdown=e():t.ColorDropdown=e()}(this,function(){return function(t){function e(n){if(o[n])return o[n].exports;var i=o[n]={i:n,l:!1,exports:{}};return t[n].call(i.exports,i,i.exports,e),i.l=!0,i.exports}var o={};return e.m=t,e.c=o,e.d=function(t,o,n){e.o(t,o)||Object.defineProperty(t,o,{configurable:!1,enumerable:!0,get:n})},e.n=function(t){var o=t&&t.__esModule?function(){return t.default}:function(){return t};return e.d(o,"a",o),o},e.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},e.p="",e(e.s=1)}([function(t,e){function o(t,e){var n=t[0],i=t[1];for(var r in i)Object.hasOwnProperty.call(i,r)&&(e&&n[r]instanceof Object&&i[r]instanceof Object?o([n[r],i[r]],!0):n[r]=i[r]);if(t.length>2){return o([n].concat(t.slice(2)),e)}return n}function n(t){return Array.prototype.slice.call(t,0)}e.isPointOver=function(t,e,o){var n=o.getBoundingClientRect();return n.top<=e&&e<=n.bottom&&n.left<=t&&t<=n.right},e.getStandaloneStyle=function(t,e,o){var n=r(o.componentStyleMap,e);n=n?n.copy():Style({});var s=n.componentStyleMap;return n.componentStyleMap={},void 0!==t.parent&&i(n.componentStyleMap,t.parent.computedStyleMap),i(n.componentStyleMap,o.componentStyleMap,s),n},e.findOverflowView=function(t,e){for(var o=t.parentNode;null!==o;o=o.parentNode){var n=window.getComputedStyle(o).getPropertyValue("overflow-"+e);if(o.parentNode===document||"visible"!==n&&""!==n)break}return o},e.getStylePxAmount=function(t,e){var o=t.getPropertyValue(e);return parseInt(o.slice(0,o.length-2),10)};var i=e.merge=function(t,e){return o(n(arguments),!1)},r=e.getStyleForComponent=function(t,e){if(void 0!==t)return s(t,e)||l(t,e)},s=e.getStyleForLabel=function(t,e){if(void 0!==e.label&&"$"+e.label in t)return t["$"+e.label]},l=e.getStyleForBlockName=function(t,e){for(var o=e.constructor;void 0!==o;){var n=t[o.name];if(void 0!==n)return n;o=o.parent}}},function(t,e,o){var n=o(2);registerPlugin(proto(Gem,function(t){this.name="ColorDropdown",this.defaultOptions=function(){return{field:"status",states:{open:"gray",inProgress:"yellow",complete:"green"}}},this.requireFields=function(t){var e={};return e[t.field]={type:"choice",choices:["open","inProgress","complete"],initial:"open"},e},this.build=function(t,e,o){var i=this,r=e.subject;this.field=r.field,this.drop=n(Block(),Block()),this.add(this.drop);var s=this.states=Object.keys(r.states);this.ticket=t,this.config=r,s.forEach(function(e){var o=Block("color"),n=i.config.states[e];o.domNode.style.backgroundColor=n;var r=Block("item",o,Text(e));r.on("click",function(){t.set(i.field,e),i.drop.close()}),i.drop.menu.add(r)}),i.updateState(),t.get(i.field).on("change",function(){i.updateState()})},this.updateState=function(){var t=this.states.indexOf(this.ticket.get(this.field).subject),e=this.config.states[this.states[t]];this.drop.button.domNode.style.backgroundColor=e,this.domNode.title=this.ticket.get(this.field).subject},this.getStyle=function(){return{DropButton:{$button:{cursor:"pointer",height:20,width:20,borderRadius:10,margin:5},$menu:{backgroundColor:"#F0F3F4",border:"1px solid #01428B",color:"#55606E",$item:{display:"flex",alignItems:"center",backgroundColor:"#E6E6E6",borderTop:"1px solid #E6E6E6",cursor:"pointer",$$hover:{backgroundColor:"white"},$color:{width:20,height:20,borderRadius:10,margin:"2px 4px"}}}}}}}))},function(t,e,o){var n=o(0),i=o(3);t.exports=proto(i,function(t){this.name="DropButton",this.build=function(){var e=this;t.build.apply(this,arguments),this.virtualAncestors=[],this.on("mousedown",function(t){0===t.button&&e.open()})},this.open=function(){if(!this.isOpen){t.open.apply(this,arguments);var e=this;setTimeout(function(){document.addEventListener("mousedown",e.closeHandler=function(t){e.virtualAncestors.concat(e.dropdown).some(function(e){return n.isPointOver(t.pageX,t.pageY,e.domNode)})||e.close()})},0)}},this.close=function(){this.isOpen&&(document.removeEventListener("mousedown",this.closeHandler),t.close.apply(this,arguments),this.closeHandler=void 0)}})},function(t,e,o){function n(t,e,o){var n=t.domNode.getBoundingClientRect(),r=t.menu;if(n.bottom>e.top&&n.top<e.bottom&&n.right>e.left&&n.left<e.right){var s=getComputedStyle(t.menu.domNode);i("v",r,s,n,o),i("h",r,s,n,o),r.visible=!0}else t.menu.visible=!1}function i(t,e,o,n,i){if("v"===t)var s="bottom",l="top",a="height",u="direction",c="getPotentialHeight",d="scrollHeight",p="clientHeight";else var s="right",l="left",a="width",u="horizontalDirection",c="getPotentialWidth",d="scrollWidth",p="clientWidth";if("v"===t)var f=n[l],h=n[s],m=1;else var f=n[s],h=n[l],m=0;var v=r.getStylePxAmount(o,"margin-"+l),g=r.getStylePxAmount(o,"margin-"+s),b=v+g;if(void 0!==e[c])var y=e[c]();else var y=e.domNode[d];var w=h+y+b-document.documentElement[p],S=y+b-f;if(w<0)var x=1,O=h-m;else if(S<0)var x=-1,O=f-y+m;else if(w<S)var x=1,k=y+g-w,O=h-m;else var x=-1,k=y+v-S,O=k-f+m;e.domNode.style[l]=O+"px",void 0!==k?(i||e.state.subject[a]!==k)&&(e.domNode.style[a]=k+"px",e.state.set(a,k)):(i||void 0!==e.state.subject[a])&&(e.domNode.style[a]="",e.state.set(a,void 0)),(i||e.state.subject[u]!==x)&&e.state.set(u,x)}var r=o(0),s=Style({overflowY:"scroll"});t.exports=proto(Gem,function(t){this.name="Dropdown",this.dropdownMenuStyle=Style({display:"block",position:"absolute",border:"1px solid black",marginTop:2,padding:2,backgroundColor:"white",zIndex:900,$state:function(t){if(void 0!==t.height)return s}}),this.defaultStyle=Style({$setup:function(t,e){var o=r.getStandaloneStyle(t,t.dropdown,e),n=t.dropdownMenuStyle.mix(o);t.dropdown.style=n},$kill:function(t){t.dropdown.style=void 0},$wrapper:{display:"block",position:"static"}}),this.build=function(){if(void 0===arguments[0]||"string"==typeof arguments[0])var t=arguments[0],e=1;else var e=0;this.button=arguments[e],this.menu=this.dropdown=arguments[e+1],this.maintainDropdownPosition=arguments[e+2],void 0===this.maintainDropdownPosition&&(this.maintainDropdownPosition=!0),this.label=t,this.isOpen=!1,this.menu.label="menu",this.menu.domNode.style.position="absolute",this.button.label="button",this.add(this.button)},this.close=function(){this.isOpen&&(this.isOpen=!1,this.menu.detach(),void 0!==this.interval&&clearInterval(this.interval),this.emit("close"))},this.open=function(){if(!this.isOpen){this.isOpen=!0;var t=this,e=r.findOverflowView(this.domNode,"y"),o=e.getBoundingClientRect();this.maintainDropdownPosition?this.interval=setInterval(function(){n(t,o)},50):setTimeout(function(){n(t,o)},50),t.menu.attach(),t.emit("open")}},this.toggle=function(){this.isOpen?this.close():this.open()}})}])});